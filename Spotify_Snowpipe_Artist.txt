CREATE OR REPLACE TABLE OUR_FIRST_DB.SPOTIFY_SCHEMA.ARTIST_DATA (
    artist_id STRING, 
    artist_name STRING,
    external_url STRING
)

CREATE OR REPLACE stage MANAGE_DB.EXTERNAL_STAGES.spotify_artist_folder
    URL='s3://spotify-etl-project-sebastian/transformed_data/artist_data/'
    STORAGE_INTEGRATION=spotify_project_s3_connection
    FILE_FORMAT = MANAGE_DB.FILE_FORMATS.spotify_csv_file_format


CREATE OR REPLACE PIPE MANAGE_DB.SPOTIFY_PIPES.ARTIST_PIPE
auto_ingest=TRUE
AS
COPY INTO OUR_FIRST_DB.SPOTIFY_SCHEMA.ARTIST_DATA 
FROM @MANAGE_DB.EXTERNAL_STAGES.spotify_artist_folder;


DESC PIPE MANAGE_DB.SPOTIFY_PIPES.ARTIST_PIPE;


SELECT * FROM OUR_FIRST_DB.SPOTIFY_SCHEMA.ARTIST_DATA;

TRUNCATE OUR_FIRST_DB.SPOTIFY_SCHEMA.ARTIST_DATA;


SELECT * FROM OUR_FIRST_DB.SPOTIFY_SCHEMA.ARTIST_DATA where ARTIST_ID = '5cj0lLjcoR7YOSnhnX0Po5'
